# WebGL 三维方向光源

方向光源（平行光）

方向光方向**点乘**面的朝向，得到两个方向夹角的余弦值（cos 是邻边比斜边，是斜边投影到邻边）

注：仅仅 RGB 需要乘 light，透明度不需要。光照方向是指光照的来源方向（光照的照射方向的反方向）

法向量：描述面的朝向的单位向量。（点在面切平面的垂直单位向量）

模型旋转了，法线也需要跟随变化，但是不是旋转到裁剪空间，变换到运算需要的坐标系，方向光是世界坐标系，所以变化需要转换到世界坐标

法线向量不关心位移，只需要 mat3，姿态部分

模型的形变（scale XYZ）会导致法线不结果不对，需要乘的到世界坐标系`逆矩阵的转置矩阵`
（这个矩阵的运算每一步骤的含义是什么？逆矩阵理解，但是转置不理解，先调过）

```js
// 转成3维矩阵，移除位移
v_normal = mat3(u_worldInverseTranspose) * a_normal;
// w置为0，相当于移除了位移
v_normal = (u_worldInverseTranspose * vec4(a_normal, 0)).xyz;
```

## 问题

侧面无 shade 效果，一直是全黑，估计和模型默认上下颠倒有关

确认是和模型默认 Y 轴相反导致，参考例子对模型增加，绕 X 轴旋转 180 度，解决（因为法线是根据旋转之后的位置定的

点乘是|a||b|cosA，颜色直接乘 cosA 的含义是？等效于沿法线方向照射的光通量
